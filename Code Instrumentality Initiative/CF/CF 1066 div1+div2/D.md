证明 $$f(p)=∑|p-a_i|$$ 为单峰函数

设给出的估计值为 a_1,a_2,...,a_n，不妨先将它们升序排序：
$$a_1 \le a_2 \le \dots \le a_n.$$

定义
$$f(p)=\sum_{i=1}^n |p-a_i|,\quad p\in\mathbb{R}.$$

要证明：f(p) 在数轴上先单调下降，后单调上升（中间可能有一段平的），因此是单峰函数（更严格地说是凸函数）。

--------------------------------------------------
1. 分段计算导数（斜率）

任取一个不等于任何 a_i 的点 p，它落在某两个相邻值之间：
$$a_k < p < a_{k+1}$$
（边界情况只需要令 k=0 或 k=n 即可）。

此时：

- 对于 i≤k，有 a_i≤p，于是
  $$|p-a_i| = p-a_i,$$
  对 p 的导数为 +1。
- 对于 i>k，有 a_i>p，于是
  $$|p-a_i| = a_i-p,$$
  对 p 的导数为 -1。

因此，在区间 (a_k,a_{k+1}) 上，
$$f'(p)
= k\cdot(+1)+(n-k)\cdot(-1)
= 2k-n.$$

也就是说：在每个开区间 (a_k,a_{k+1}) 上，f(p) 是线性的，其斜率为常数
$$2k-n.$$

--------------------------------------------------
2. 斜率单调不减 ⇒ 函数先降后升

当 p 从 -∞ 向右移动时，依次经过
$$a_1,a_2,\dots,a_n.$$
每经过一个 a_i，区间编号 k 增加 1，斜率
$$f'(p)=2k-n$$
就增加 2。于是：

- 最左侧 k=0 时，斜率
  $$f'(p)=-n<0,$$
  函数严格下降；
- 每跨过一个 a_i，斜率加 2，从
  $$-n,\,-n+2,\,-n+4,\,\dots,\,+n$$
  依次跳升；
- 最右侧 k=n 时，斜率
  $$f'(p)=+n>0,$$
  函数严格上升。

斜率 f'(p) 是一个单调不减的阶梯函数，因此 f(p) 是一个凸函数：先严格下降（斜率<0），中间可能出现一段斜率=0（函数平的），再严格上升（斜率>0）。这正是单峰函数的形式：在实数轴上先单调减，再单调增。

--------------------------------------------------
3. 最小值位置：中位数

由
$$f'(p)=2k-n$$
可见，当
$$2k-n<0$$
时斜率为负，当
$$2k-n>0$$
时斜率为正。记 n 为元素个数。

(1) n 为奇数：

此时
$$k=\frac{n-1}{2}\Rightarrow f'(p)=-1<0,$$
$$k=\frac{n+1}{2}\Rightarrow f'(p)=+1>0.$$
因此在
$$p=a_{\frac{n+1}{2}}$$
处斜率由负变正，f(p) 在该点取得唯一最小值，这个点就是中位数。

(2) n 为偶数：

此时
$$k=\frac{n}{2}-1 \Rightarrow f'(p)=-2<0,$$
$$k=\frac{n}{2} \Rightarrow f'(p)=0,$$
$$k=\frac{n}{2}+1 \Rightarrow f'(p)=2>0.$$
因此在区间
$$[a_{n/2},\,a_{n/2+1}]$$
内斜率为 0，f(p) 在这整段上都取得最小值，这一段就是“中位区间”。

总结：

- n 为奇数：最小值在唯一的中位数
  $$a_{(n+1)/2}$$
  处取得；
- n 为偶数：最小值在中位区间
  $$[a_{n/2},\,a_{n/2+1}]$$
  上取得。

--------------------------------------------------
结论（用于本题）

对任意数组 a_1,...,a_n，函数
$$f(p)=\sum_{i=1}^n |p-a_i|$$
在数轴上是一个先减后增的单峰函数，在中位数（或中位区间）处取得全局最小值。

若要求 p 必须位于区间 [L,R] 中，则
$$\arg\min_{p\in[L,R]} f(p)$$
一定是“把中位数压到 [L,R] 里的点”：

- 若中位数 m<L，则最优 p=L；
- 若中位数 m>R，则最优 p=R；
- 否则任意
  $$p\in[m_1,m_2]\cap[L,R]$$（其中$$[m_1,m_2]$$为中位区间）都是最优。

